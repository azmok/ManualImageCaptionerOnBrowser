<!DOCTYPE html>
<html lang="en">

<head>
   <meta charset="UTF-8" />
   <meta name="viewport" content="width=device-width, initial-scale=1.0" />
   <title>Manual Image Captioner - AI Training Dataset Tool</title>
   <link rel="stylesheet" href="css/style.css" />
</head>

<body>
   <div class="btn" id="btn_settomgsToggle">〓</div>
   <!-- Add this to your index.html in the upload area -->
   <div id="uploadProgressContainer" class="progress-container" style="display: none;">
      <div class="progress-bar">
         <div id="uploadProgressBar" class="progress-fill"></div>
      </div>
      <div id="uploadProgressText" class="progress-text">0%</div>
      <div id="uploadFileInfo" class="file-info"></div>
   </div>


   <div class="app-container">

      <div class="main-content">
         <header class="header">
            <h1>🎨 Manual Captioning Webapp</h1>
         </header>
         <section class="upload-section">
            <label for="fileInput" class="upload-label">📸 Upload Images + Caption Files</label>
            <input id="fileInput" type="file" multiple accept="image/*, .txt" />
            <div id="uploadArea" class="upload-area">
               <div style="font-size: 3em; margin-bottom: 20px">📁</div>
               <h3>Drag & Drop Images or Caption Files Here</h3>
               <p>Support for images (JPG, PNG, WebP) + text files (.txt)</p>
               <p style="margin-top: 10px; font-size: 0.9em; color: #718096">
                  💡 Upload matching files: image1.jpg + image1.txt for auto-caption loading
               </p>
            </div>
         </section>
         <section class="progress-section">
            <div id="imageCount">0 images</div>
            <div class="progress-bar">
               <div id="progressFill"></div>
            </div>
            <div id="captionedCount">0 captioned</div>
         </section>
         <main id="gallery"></main>
         <div id="emptyState" class="empty-state">
            <h3>Ready to create your dataset! 🚀</h3>
            <p>Upload images and optional .txt caption files to start captioning</p>
         </div>
      </div>

      <aside id="sidePanel">
         <div id="sidePanelHandle"></div>
         <h3>📝 Tags & Sentences</h3>
         <ul id="captionList"></ul>
         <div class="controls-panel">
            <button id="clearAllBtn" class="btn btn-primary">🗑️Clear All</button>
            <button id="downloadDatasetBtn" class="btn btn-success">📦Download Dataset</button>
            <button id="autoSaveBtn" class="btn btn-secondary">Save Progress</button>
         </div>
         <div class="search-replace-panel">
            <h1>Text Manipulation Tool</h1>

            <div id="user-input-panel">
               <div class="choice_replace_insert">
                  <h3>Insert/Replace</h3>
                  <div class="radio-group">
                     <label for="choice_replace">
                        <input type="radio" name="replaceType" id="choice_replace" value="replace">
                        Replace
                     </label>
                     <label for="choice_insert">
                        <input type="radio" name="replaceType" id="choice_insert" value="insert" checked>
                        Insert
                     </label>
                     <input type="checkbox" id="insertIfAbsence" class="insertIfAbsence">
                     <label for="insertIfAbsence" class="insertIfAbsence">If Absent</label>
                  </div>
               </div>

               <div class="input-group search_type">
                  <h3>Search type:</h3>
                  <div class="radio-group">
                     <label for="searchType1">
                        <input type="radio" name="searchType" id="searchType1" value="text">
                        Text
                     </label>
                     <label for="searchType2">
                        <input type="radio" name="searchType" id="searchType2" value="regex" checked>
                        Regex Search
                     </label>
                  </div>
               </div>

               <div class="input-group text_to_search">
                  <label for="input1" id="input1Label">1. Text to search:</label>
                  <input type="text" id="input1" placeholder="Enter text or regex pattern">
               </div>

               <div class="input-group insert_position show" id="insertPositionPanel">
                  <label>Insertion position:</label>
                  <div class="radio-group">
                     <label for="insert_prepend">
                        <input type="radio" name="position" id="insert_prepend" value="prepend" checked>
                        Before (Prepend)
                     </label>
                     <label for="insert_append">
                        <input type="radio" name="position" id="insert_append" value="append">
                        After (Append)
                     </label>
                  </div>
               </div>

               <div class="input-group text_to_insert">
                  <label for="input2" id="input2Label">2. Text to Insert:</label>
                  <input type="text" id="input2" placeholder="Enter text to insert/replace">
               </div>

               <button id="runButton">Apply Changes</button>
            </div>
         </div>
      </aside>
   </div>
   <div id="notification" class="notification"></div>
   <div class="controls-panel">
      <button class="btn btn-primary" id="downloadDatasetBtn-2">📦Download Dataset</button>
      <button class="btn btn-secondary" id="saveProgressBtn">💾Save Progress</button>
      <button class="btn btn-danger" id="clearAllBtn-2">🗑️Clear All</button>
   </div>
   <button class="btn btn-primary" id="loadProgressBtn">♻️Restore Last Session</button>
   <button class="btn btn-primary" id="saveProject">save project to DB</button>


   <script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.1/jszip.min.js"></script>

   <script type='module' src="js/main.js"></script>
   <script type='module' src="js/replace_panel.js"></script>
</body>

</html>